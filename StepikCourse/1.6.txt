1. Вывести из таблицы trip информацию о командировках тех сотрудников, фамилия которых заканчивается на букву «а», в отсортированном по убыванию даты последнего дня командировки виде. В результат включить столбцы name, city, per_diem, date_first, date_last.

select name, city, per_diem, date_first, date_last from trip
where name like '%а %%'
order by date_last DESC;

------------------------------------------
2. Вывести в алфавитном порядке фамилии и инициалы тех сотрудников, которые были в командировке в Москве.

select  distinct name from trip
where city = 'Москва'
order by name ASC;

-----------------------------------------
3. Для каждого города посчитать, сколько раз сотрудники в нем были.  Информацию вывести в отсортированном в алфавитном порядке по названию городов. Вычисляемый столбец назвать Количество

select city, count(city) as Количество from trip
group by city
order by city ASC;

-------------------------------------------
Для ограничения вывода записей в SQL используется оператор LIMIT , после которого указывается количество строк.  Результирующая таблица будет иметь количество строк не более указанного после LIMIT. LIMIT размещается после раздела ORDER BY.

Как правило, этот оператор используется, чтобы отобрать заданное количество отсортированных строк результата запроса. 

4. Вывести два города, в которых чаще всего были в командировках сотрудники. Вычисляемый столбец назвать Количество

select city, count(city) as Количество from trip
group by city
order by count(city) DESC
limit 2;

---------------------------------------------
Для вычитания двух дат используется функция DATEDIFF(дата_1, дата_2), результатом которой является количество дней между дата_1 и дата_2.

5. Вывести информацию о командировках во все города кроме Москвы и Санкт-Петербурга (фамилии и инициалы сотрудников, город ,  длительность командировки в днях, при этом первый и последний день относится к периоду командировки). Последний столбец назвать Длительность. Информацию вывести в упорядоченном по убыванию длительности поездки, а потом по убыванию названий городов (в обратном алфавитном порядке).

select name, city, DATEDIFF(date_last, date_first)+1 as Длительность  from trip
where city not in ('Москва', 'Санкт-Петербург')
order by Длительность DESC, city DESC;

--------------------------------------------
6. Вывести информацию о командировках сотрудника(ов), которые были самыми короткими по времени. В результат включить столбцы name, city, date_first, date_last.

select name, city, date_first, date_last from trip
where datediff(date_last, date_first) = (select min(date_last - date_first) from trip);

------------------------------------------------
Для того, чтобы выделить номер месяца из даты используется функция MONTH(дата).

Например, MONTH('2020-04-12') = 4.

7. Вывести информацию о командировках, начало и конец которых относятся к одному месяцу (год может быть любой). В результат включить столбцы name, city, date_first, date_last. Строки отсортировать сначала  в алфавитном порядке по названию города, а затем по фамилии сотрудника .

select name, city, date_first, date_last from trip
where month(date_first) = month(date_last)
order by city, name;

----------------------------------------------------
Для того, чтобы выделить название месяца из даты используется функция MONTHNAME(дата), которая возвращает название месяца на английском языке для указанной даты. Например, MONTHNAME('2020-04-12')='April'.
Если группировка осуществляется по вычисляемому столбцу (в данном случае «вычисляется» название месяца), то после GROUP BYможно указать как вычисляемое выражение, так и имя столбца, заданное с помощью AS. Важно отметить, что последний вариант (указать имя столбца)  нарушает стандарт по порядку выполнения запросов, но иногда может встречаться на реальных платформах.

8. Вывести название месяца и количество командировок для каждого месяца. Считаем, что командировка относится к некоторому месяцу, если она началась в этом месяце. Информацию вывести сначала в отсортированном по убыванию количества, а потом в алфавитном порядке по названию месяца виде. Название столбцов – Месяц и Количество.

select monthname(date_first) as Месяц, count(monthname(date_first)) as Количество from trip
group by Месяц
order by Количество desc, Месяц;


-------------------------------------------------------
